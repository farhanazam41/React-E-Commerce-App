{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\farha\\\\Desktop\\\\reacttest\\\\components\\\\Account\\\\AccountPermissions.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport axios from 'axios';\nimport baseUrl from '../../utils/baseUrl';\nimport cookie from 'js-cookie';\nimport { Header, Checkbox, Table, Icon, Tab } from 'semantic-ui-react';\nimport formatDate from '../../utils/formatDate';\n\nfunction AccountPermissions() {\n  var _React$useState = React.useState([]),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      users = _React$useState2[0],\n      setUsers = _React$useState2[1];\n\n  React.useEffect(function () {\n    getUsers();\n  }, []);\n\n  function getUsers() {\n    return _getUsers.apply(this, arguments);\n  }\n\n  function _getUsers() {\n    _getUsers = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var url, token, payload, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              url = \"\".concat(baseUrl, \"/api/users\");\n              token = cookie.get('token');\n              payload = {\n                headers: {\n                  Authorization: token\n                }\n              };\n              _context.next = 5;\n              return axios.get(url, payload);\n\n            case 5:\n              response = _context.sent;\n              setUsers(response.data);\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _getUsers.apply(this, arguments);\n  }\n\n  return __jsx(\"div\", {\n    style: {\n      margin: '2em 0'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 25\n    },\n    __self: this\n  }, __jsx(Header, {\n    as: \"h2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 26\n    },\n    __self: this\n  }, __jsx(Icon, {\n    name: \"settings\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27\n    },\n    __self: this\n  }), \"User Permissions\"), __jsx(Table, {\n    compact: true,\n    celled: true,\n    definition: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30\n    },\n    __self: this\n  }, __jsx(Table.Header, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31\n    },\n    __self: this\n  }, __jsx(Table.Row, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32\n    },\n    __self: this\n  }, __jsx(Table.HeaderCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33\n    },\n    __self: this\n  }), __jsx(Table.HeaderCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34\n    },\n    __self: this\n  }, \"Name\"), __jsx(Table.HeaderCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35\n    },\n    __self: this\n  }, \"Email\"), __jsx(Table.HeaderCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36\n    },\n    __self: this\n  }, \"Joined\"), __jsx(Table.HeaderCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37\n    },\n    __self: this\n  }, \"Updated\"), __jsx(Table.HeaderCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38\n    },\n    __self: this\n  }, \"Role\"))), __jsx(Table.Body, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41\n    },\n    __self: this\n  }, users.map(function (user) {\n    return __jsx(UserPermission, {\n      key: user._id,\n      user: user,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    });\n  }))));\n}\n\nfunction UserPermission(_ref) {\n  var user = _ref.user;\n\n  var _React$useState3 = React.useState(user.role === 'admin'),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      admin = _React$useState4[0],\n      setAdmin = _React$useState4[1];\n\n  var isFirstRun = React.useRef(true);\n  React.useEffect(function () {\n    if (isFirstRun.current) {\n      isFirstRun.current = false;\n      return;\n    }\n\n    updatePermission();\n  }, [admin]);\n\n  function handleChangePermission() {\n    setAdmin(function (prevState) {\n      return !prevState;\n    });\n  }\n\n  function updatePermission() {\n    return _updatePermission.apply(this, arguments);\n  }\n\n  function _updatePermission() {\n    _updatePermission = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var url, payload;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              url = \"\".concat(baseUrl, \"/api/account\");\n              payload = {\n                _id: user._id,\n                role: admin ? 'admin' : 'user'\n              };\n              _context2.next = 4;\n              return axios.put(url, payload);\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _updatePermission.apply(this, arguments);\n  }\n\n  return __jsx(Table.Row, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, __jsx(Table.Cell, {\n    collapsing: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, __jsx(Checkbox, {\n    checked: admin,\n    toggle: true,\n    onChange: handleChangePermission,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  })), __jsx(Table.Cell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, user.name), __jsx(Table.Cell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, user.email), __jsx(Table.Cell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, formatDate(user.createdAt)), __jsx(Table.Cell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, formatDate(user.updatedAt)), __jsx(Table.Cell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, admin ? 'admin' : 'user'));\n}\n\nexport default AccountPermissions;","map":{"version":3,"sources":["C:\\Users\\farha\\Desktop\\reacttest\\components\\Account\\AccountPermissions.js"],"names":["React","axios","baseUrl","cookie","Header","Checkbox","Table","Icon","Tab","formatDate","AccountPermissions","useState","users","setUsers","useEffect","getUsers","url","token","get","payload","headers","Authorization","response","data","margin","map","user","_id","UserPermission","role","admin","setAdmin","isFirstRun","useRef","current","updatePermission","handleChangePermission","prevState","put","name","email","createdAt","updatedAt"],"mappings":"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","sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport baseUrl from '../../utils/baseUrl';\nimport cookie from 'js-cookie';\nimport { Header, Checkbox, Table, Icon, Tab } from 'semantic-ui-react';\nimport formatDate from '../../utils/formatDate';\n\nfunction AccountPermissions() {\n \n  const [ users , setUsers] = React.useState([])\n\n  React.useEffect(() => {\n   getUsers();\n  } , []);\n\n  async function getUsers(){\n    const url = `${baseUrl}/api/users`;\n    const token = cookie.get('token');\n    const payload = { headers : { Authorization: token}};\n    const response = await axios.get(url, payload);\n    setUsers(response.data);\n  }\n\n  return (\n    <div style={{ margin: '2em 0'}}>\n    <Header as='h2' >\n    <Icon name='settings' />\n    User Permissions\n    </Header>\n     <Table  compact celled definition>\n     <Table.Header>\n     <Table.Row>\n     <Table.HeaderCell/>\n     <Table.HeaderCell>Name</Table.HeaderCell>\n     <Table.HeaderCell>Email</Table.HeaderCell>\n     <Table.HeaderCell>Joined</Table.HeaderCell>\n     <Table.HeaderCell>Updated</Table.HeaderCell>\n     <Table.HeaderCell>Role</Table.HeaderCell>\n     </Table.Row>\n     </Table.Header>\n     <Table.Body>\n     {users.map(user => (\n       <UserPermission key={user._id} user={user} />\n     ))}\n     </Table.Body>\n     </Table>\n    </div>\n  );\n}\n\n  function UserPermission({user}){\n\n     const [ admin, setAdmin ] = React.useState(user.role === 'admin');\n     const isFirstRun =  React.useRef(true);\n\n     React.useEffect(() => {\n       if(isFirstRun.current){\n         isFirstRun.current = false ;\n         return;\n       }\n         updatePermission();\n\n     }, [admin]) ;\n\n     \n\n\n     function handleChangePermission(){\n       setAdmin(prevState => !prevState)\n     }\n\n     async function updatePermission(){\n       const url = `${baseUrl}/api/account`;\n       const payload = { _id: user._id , role : admin ? 'admin' : 'user' }\n       await axios.put( url, payload)\n     }\n\n    return ( \n      <Table.Row>\n      <Table.Cell collapsing >\n      <Checkbox checked={admin} toggle onChange={handleChangePermission} />\n      </Table.Cell>\n      <Table.Cell>{user.name}</Table.Cell>\n      <Table.Cell>{user.email}</Table.Cell>\n      <Table.Cell>{formatDate(user.createdAt)}</Table.Cell>\n      <Table.Cell>{formatDate(user.updatedAt)}</Table.Cell>\n      <Table.Cell>{admin ? 'admin' : 'user'}</Table.Cell>\n      </Table.Row>\n    )\n  }\n\nexport default AccountPermissions;\n"]},"metadata":{},"sourceType":"module"}